female$diameter[female$patnr == subject_id],
col=alpha(i, 0.5))
lines(female$age, ci_prediction_male[newdata$patnr == subject_id,1], lty = 1, col = i)
lines(female$age, ci_prediction_male[newdata$patnr == subject_id,2], lty = 2, col= i)
lines(female$age, ci_prediction_male[newdata$patnr == subject_id,3], lty = 2, col= i)
}
View(female)
par(mfrow=c(2,2))
for(i in female$patnr){
subject_id = i
print(subject_id)
plot(female$age, female$diameter[female$patnr == subject_id],
xlab="Age", ylab="Diameter", type="n",
col="red",
ylim=c(18, 65), xlim=c(0, 140),
main = paste("aaa: ", subject_id))
lines(female$age[female$patnr == subject_id],
female$diameter[female$patnr == subject_id],
col=alpha(i, 0.5))
lines(female$age, ci_prediction_female[newdata$patnr == subject_id,1], lty = 1, col = i)
lines(female$age, ci_prediction_female[newdata$patnr == subject_id,2], lty = 2, col= i)
lines(female$age, ci_prediction_female[newdata$patnr == subject_id,3], lty = 2, col= i)
}
for(i in female$patnr){
subject_id = i
print(subject_id)}
for(i in female$patnr){
subject_id = i
print(subject_id)
plot(female$age, female$diameter[i],
xlab="Age", ylab="Diameter", type="n",
col="red",
ylim=c(18, 65), xlim=c(0, 140),
main = paste("aaa: ", subject_id))
lines(female$age[female$patnr == subject_id],
female$diameter[female$patnr == subject_id],
col=alpha(i, 0.5))
lines(female$age, ci_prediction_female[newdata$patnr == subject_id,1], lty = 1, col = i)
lines(female$age, ci_prediction_female[newdata$patnr == subject_id,2], lty = 2, col= i)
lines(female$age, ci_prediction_female[newdata$patnr == subject_id,3], lty = 2, col= i)
}
par(mfrow=c(2,2))
for(i in female$patnr){
subject_id = i
print(subject_id)
plot(female$age[i], female$diameter[i],
xlab="Age", ylab="Diameter", type="n",
col="red",
ylim=c(18, 65), xlim=c(0, 140),
main = paste("aaa: ", subject_id))
lines(female$age[female$patnr == subject_id],
female$diameter[female$patnr == subject_id],
col=alpha(i, 0.5))
lines(female$age, ci_prediction_female[newdata$patnr == subject_id,1], lty = 1, col = i)
lines(female$age, ci_prediction_female[newdata$patnr == subject_id,2], lty = 2, col= i)
lines(female$age, ci_prediction_female[newdata$patnr == subject_id,3], lty = 2, col= i)
}
par(mfrow=c(2,2))
for(i in female$patnr){
subject_id = i
print(subject_id)
plot(female$age[i], female$diameter[i],
xlab="Age", ylab="Diameter", type="n",
col="red",
ylim=c(18, 65), xlim=c(0, 140),
main = paste("aaa: ", subject_id))
lines(female$age[i],
female$diameter[i],
col=alpha(i, 0.5))
lines(female$age, ci_prediction_female[newdata$patnr == subject_id,1], lty = 1, col = i)
lines(female$age, ci_prediction_female[newdata$patnr == subject_id,2], lty = 2, col= i)
lines(female$age, ci_prediction_female[newdata$patnr == subject_id,3], lty = 2, col= i)
}
par(mfrow=c(2,2))
for(i in female$patnr){
subject_id = i
print(subject_id)
plot(female$age[i], female$diameter[i],
xlab="Age", ylab="Diameter", type="n",
col="red",
ylim=c(18, 65), xlim=c(0, 140),
main = paste("aaa: ", subject_id))
lines(female$age[i],
female$diameter[i],
col=alpha(i, 0.5))
print(i)
lines(female$age, ci_prediction_female[newdata$patnr == subject_id,1], lty = 1, col = i)
lines(female$age, ci_prediction_female[newdata$patnr == subject_id,2], lty = 2, col= i)
lines(female$age, ci_prediction_female[newdata$patnr == subject_id,3], lty = 2, col= i)
}
par(mfrow=c(2,2))
for(i in female$patnr){
subject_id = i
print(subject_id)
plot(female$age[i], female$diameter[i],
xlab="Age", ylab="Diameter", type="n",
col="red",
ylim=c(18, 65), xlim=c(0, 140),
main = paste("aaa: ", subject_id))
lines(female$age[i],
female$diameter[i],
col=alpha(i, 0.5))}
par(mfrow=c(2,2))
for(i in female$patnr){
subject_id = i
print(subject_id)
plot(female$age[i], female$diameter[i],
xlab="Age", ylab="Diameter", type="n",
col="red",
ylim=c(18, 65), xlim=c(0, 140),
main = paste("aaa: ", subject_id))
lines(female$age[i],
female$diameter[i],
col=alpha(i, 0.5))
lines(female$age, ci_prediction_female[female$patnr == subject_id,1], lty = 1, col = i)
lines(female$age, ci_prediction_female[female$patnr == subject_id,2], lty = 2, col= i)
lines(female$age, ci_prediction_female[female$patnr == subject_id,3], lty = 2, col= i)
}
par(mfrow=c(2,2))
for(i in female$patnr){
subject_id = i
print(subject_id)
plot(female$age[i], female$diameter[i],
xlab="Age", ylab="Diameter", type="n",
col="red",
ylim=c(18, 65), xlim=c(0, 140),
main = paste("aaa: ", subject_id))
lines(female$age[i],
female$diameter[i],
col=alpha(i, 0.5))
lines(female$age[i], ci_prediction_female[female$patnr == subject_id,1], lty = 1, col = i)
lines(female$age[i], ci_prediction_female[female$patnr == subject_id,2], lty = 2, col= i)
lines(female$age[i], ci_prediction_female[female$patnr == subject_id,3], lty = 2, col= i)
}
for(i in female$patnr){
subject_id = i
print(subject_id)
plot(female$age[i], female$diameter[i],
xlab="Age", ylab="Diameter", type="n",
col="red",
ylim=c(18, 65), xlim=c(0, 140),
main = paste("aaa: ", subject_id))
lines(female$age[i],
female$diameter[i],
col=alpha(i, 0.5))
lines(female$age[i], ci_prediction_female[female$patnr == subject_id,1], lty = 1, col = i)
lines(female$age[i], ci_prediction_female[female$patnr == subject_id,2], lty = 2, col= i)
lines(female$age[i], ci_prediction_female[female$patnr == subject_id,3], lty = 2, col= i)
}
for(i in female$patnr){
subject_id = i
print(subject_id)
plot(female$age[i], female$diameter[i],
xlab="Age", ylab="Diameter", type="n",
col="red",
ylim=c(18, 65), xlim=c(0, 140),
main = paste("aaa: ", subject_id))
lines(female$age[i],
female$diameter[i],
col=alpha(i, 0.5))
lines(female$age, ci_prediction_female[female$patnr == subject_id,1], lty = 1, col = i)
lines(female$age, ci_prediction_female[female$patnr == subject_id,2], lty = 2, col= i)
lines(female$age, ci_prediction_female[female$patnr == subject_id,3], lty = 2, col= i)
}
for(i in unique(marfan$patnr)){
subject_id = i
print(subject_id)}
for(i in unique(marfan$patnr)){
subject_id = i
print(subject_id)
plot(marfan$age[i], female$diameter[i],
xlab="Age", ylab="Diameter", type="n",
col="red",
ylim=c(18, 65), xlim=c(0, 140),
main = paste("aaa: ", subject_id))
lines(female$age[i],
female$diameter[i],
col=alpha(i, 0.5))
lines(marfan$age, ci_prediction[female$patnr == subject_id,1], lty = 1, col = i)
lines(marfan$age, ci_prediction[female$patnr == subject_id,2], lty = 2, col= i)
lines(marfan$age, ci_prediction[female$patnr == subject_id,3], lty = 2, col= i)
}
par(mfrow=c(2,2))
for(i in unique(marfan$patnr)){
subject_id = i
print(subject_id)
plot(marfan$age[i], female$diameter[i],
xlab="Age", ylab="Diameter", type="n",
col="red",
ylim=c(18, 65), xlim=c(0, 140),
main = paste("aaa: ", subject_id))
lines(female$age[i],
female$diameter[i],
col=alpha(i, 0.5))
lines(marfan$age, ci_prediction[female$patnr == subject_id,1], lty = 1, col = i)
lines(marfan$age, ci_prediction[female$patnr == subject_id,2], lty = 2, col= i)
lines(marfan$age, ci_prediction[female$patnr == subject_id,3], lty = 2, col= i)
}
par(mfrow=c(2,2))
for(i in unique(marfan$patnr)){
subject_id = i
print(subject_id)
plot(marfan$age[i], female$diameter[i],
xlab="Age", ylab="Diameter", type="n",
col="red",
ylim=c(18, 65), xlim=c(0, 140),
main = paste("aaa: ", subject_id))
lines(female$age[i],
female$diameter[i],
col=alpha(i, 0.5))
lines(marfan$age, ci_prediction[marfan$patnr == subject_id,1], lty = 1, col = i)
lines(marfan$age, ci_prediction[marfan$patnr == subject_id,2], lty = 2, col= i)
lines(marfan$age, ci_prediction[marfan$patnr == subject_id,3], lty = 2, col= i)
}
par(mfrow=c(2,2))
for(i in unique(marfan$patnr)){
subject_id = i
print(subject_id)
plot(marfan$age[i], female$diameter[i],
xlab="Age", ylab="Diameter", type="n",
col="red",
ylim=c(18, 65), xlim=c(0, 140),
main = paste("aaa: ", subject_id))
lines(female$age[i],
female$diameter[i],
col=alpha(i, 0.5))
lines(marfan$age[i], ci_prediction[marfan$patnr == subject_id,1], lty = 1, col = i)
lines(marfan$age[i], ci_prediction[marfan$patnr == subject_id,2], lty = 2, col= i)
lines(marfan$age[i], ci_prediction[marfan$patnr == subject_id,3], lty = 2, col= i)
}
par(mfrow=c(2,2))
for(i in unique(marfan$patnr)){
subject_id = i
print(subject_id)
plot(marfan$age[i], female$diameter[i],
xlab="Age", ylab="Diameter", type="n",
col="red",
ylim=c(18, 65), xlim=c(0, 140),
main = paste("aaa: ", subject_id))
lines(marfan$age[i],
marfan$diameter[i],
col=alpha(i, 0.5))
lines(marfan$age[i], ci_prediction[marfan$patnr == subject_id,1], lty = 1, col = i)
lines(marfan$age[i], ci_prediction[marfan$patnr == subject_id,2], lty = 2, col= i)
lines(marfan$age[i], ci_prediction[marfan$patnr == subject_id,3], lty = 2, col= i)
}
par(mfrow=c(2,2))
for(i in unique(marfan$patnr)){
subject_id = i
print(subject_id)
plot(marfan$age[i], female$diameter[i],
xlab="Age", ylab="Diameter", type="n",
col="red",
ylim=c(18, 65), xlim=c(0, 140),
main = paste("aaa: ", subject_id))
lines(marfan$age[i],
marfan$diameter[i],
col=alpha(i, 0.5))
lines(marfan$age[i], ci_prediction[i,1], lty = 1, col = i)
lines(marfan$age[i], ci_prediction[i,2], lty = 2, col= i)
lines(marfan$age[i], ci_prediction[i,3], lty = 2, col= i)
}
for(i in unique(marfan$patnr)){
subject_id = i
print(subject_id)
plot(marfan$age[i], female$diameter[i],
xlab="Age", ylab="Diameter", type="n",
col="red",
ylim=c(18, 65), xlim=c(0, 140),
main = paste("aaa: ", subject_id))
lines(marfan$age[i],
marfan$diameter[i],
col=alpha(i, 0.5))
lines(marfan$age[i], ci_prediction[i,1], lty = 1, col = i)
lines(marfan$age[i], ci_prediction[i,2], lty = 2, col= i)
lines(marfan$age[i], ci_prediction[i,3], lty = 2, col= i)
}
par(mfrow=c(1,1))
for(i in unique(marfan$patnr)){
subject_id = i
print(subject_id)
plot(marfan$age[i], female$diameter[i],
xlab="Age", ylab="Diameter", type="n",
col="red",
ylim=c(18, 65), xlim=c(0, 140),
main = paste("aaa: ", subject_id))
lines(marfan$age[i],
marfan$diameter[i],
col=alpha(i, 0.5))
lines(marfan$age[i], ci_prediction[i,1], lty = 1, col = i)
lines(marfan$age[i], ci_prediction[i,2], lty = 2, col= i)
lines(marfan$age[i], ci_prediction[i,3], lty = 2, col= i)
}
par(mfrow=c(1,1))
for(i in unique(marfan$patnr)){
subject_id = i
print(subject_id)
plot(marfan$age[i], female$diameter[i],
xlab="Age", ylab="Diameter", type="n",
col="red",
ylim=c(18, 65), xlim=c(0, 140),
main = paste("aaa: ", subject_id))
lines(marfan$age[i],
marfan$diameter[i],
col=alpha(i, 0.5))
lines(marfan$age, ci_prediction[i,1], lty = 1, col = i)
lines(marfan$age, ci_prediction[i,2], lty = 2, col= i)
lines(marfan$age, ci_prediction[i,3], lty = 2, col= i)
}
par(mfrow=c(1,1))
for(i in unique(marfan$patnr)){
subject_id = i
print(subject_id)
plot(marfan$age[i], female$diameter[i],
xlab="Age", ylab="Diameter", type="n",
col="red",
ylim=c(18, 65), xlim=c(0, 140),
main = paste("aaa: ", subject_id))
lines(marfan$age[i],
marfan$diameter[i],
col=alpha(i, 0.5))
print("asdf")
lines(marfan$age, ci_prediction[i,1], lty = 1, col = i)
lines(marfan$age, ci_prediction[i,2], lty = 2, col= i)
lines(marfan$age, ci_prediction[i,3], lty = 2, col= i)
}
par(mfrow=c(1,1))
for(i in unique(marfan$patnr)){
subject_id = i
print(subject_id)
plot(marfan$age[i], female$diameter[i],
xlab="Age", ylab="Diameter", type="n",
col="red",
ylim=c(18, 65), xlim=c(0, 140),
main = paste("aaa: ", subject_id))
lines(marfan$age[i],
marfan$diameter[i],
col=alpha(i, 0.5))
lines(marfan$age, ci_prediction[newdata$patnr == subject_id,1], lty = 1, col = i)
lines(marfan$age, ci_prediction[newdata$patnr == subject_id,2], lty = 2, col= i)
lines(marfan$age, ci_prediction[newdata$patnr == subject_id,3], lty = 2, col= i)
}
ci_prediction <- predictInterval(model3, newdata=newdata)
par(mfrow=c(1,1))
for(i in unique(marfan$patnr)){
subject_id = i
print(subject_id)
plot(marfan$age[i], female$diameter[i],
xlab="Age", ylab="Diameter", type="n",
col="red",
ylim=c(18, 65), xlim=c(0, 140),
main = paste("aaa: ", subject_id))
lines(marfan$age[i],
marfan$diameter[i],
col=alpha(i, 0.5))
lines(marfan$age, ci_prediction[newdata$patnr == subject_id,1], lty = 1, col = i)
lines(marfan$age, ci_prediction[newdata$patnr == subject_id,2], lty = 2, col= i)
lines(marfan$age, ci_prediction[newdata$patnr == subject_id,3], lty = 2, col= i)
}
newdata <- data.frame(patnr = pred_one$patnr,age = pred_one$age,  sexe = pred_one$sexe, diameter = pred_one$diameter)
ci_prediction <- predictInterval(model3, newdata=newdata)
View(ci_prediction)
par(mfrow=c(1,1))
for(i in unique(marfan$patnr)){
subject_id = i
print(subject_id)
plot(marfan$age[i], female$diameter[i],
xlab="Age", ylab="Diameter", type="n",
col="red",
ylim=c(18, 65), xlim=c(0, 140),
main = paste("aaa: ", subject_id))
lines(marfan$age[i],
marfan$diameter[i],
col=alpha(i, 0.5))
lines(marfan$age, ci_prediction[newdata$patnr == subject_id,1], lty = 1, col = i)
lines(marfan$age, ci_prediction[newdata$patnr == subject_id,2], lty = 2, col= i)
lines(marfan$age, ci_prediction[newdata$patnr == subject_id,3], lty = 2, col= i)
}
par(mfrow=c(1,1))
for(i in unique(marfan$patnr)){
subject_id = i
print(subject_id)
plot(marfan$age[i], female$diameter[i],
xlab="Age", ylab="Diameter", type="n",
col="red",
ylim=c(18, 65), xlim=c(0, 140),
main = paste("aaa: ", subject_id))
lines(marfan$age[i],
marfan$diameter[i],
col=alpha(i, 0.5))
lines(newdata$age, ci_prediction[newdata$patnr == subject_id,1], lty = 1, col = i)
lines(newdata$age, ci_prediction[newdata$patnr == subject_id,2], lty = 2, col= i)
lines(newdata$age, ci_prediction[newdata$patnr == subject_id,3], lty = 2, col= i)
}
par(mfrow=c(1,1))
for(i in unique(marfan$patnr)){
subject_id = i
print(subject_id)
plot(marfan$age[i], female$diameter[i],
xlab="Age", ylab="Diameter", type="n",
col="red",
ylim=c(18, 65), xlim=c(0, 140),
main = paste("aaa: ", subject_id))
lines(marfan$age[i],
marfan$diameter[i],
col=alpha(i, 0.5))
lines(20:40, ci_prediction[newdata$patnr == subject_id,1], lty = 1, col = i)
lines(20:40, ci_prediction[newdata$patnr == subject_id,2], lty = 2, col= i)
lines(20:40, ci_prediction[newdata$patnr == subject_id,3], lty = 2, col= i)
}
par(mfrow=c(1,1))
for(i in unique(marfan$patnr)){
subject_id = i
print(subject_id)
plot(marfan$age[i], female$diameter[i],
xlab="Age", ylab="Diameter", type="n",
col="red",
ylim=c(18, 65), xlim=c(0, 140),
main = paste("aaa: ", subject_id))
lines(marfan$age[i],
marfan$diameter[i],
col=alpha(i, 0.5))
lines(1, ci_prediction[newdata$patnr == subject_id,1], lty = 1, col = i)
lines(1, ci_prediction[newdata$patnr == subject_id,2], lty = 2, col= i)
lines(1, ci_prediction[newdata$patnr == subject_id,3], lty = 2, col= i)
}
par(mfrow=c(1,1))
for(i in unique(marfan$patnr)){
subject_id = i
print(subject_id)
plot(marfan$age[i], marfan$diameter[i],
xlab="Age", ylab="Diameter", type="n",
col="red",
ylim=c(18, 65), xlim=c(0, 140),
main = paste("aaa: ", subject_id))
lines(marfan$age[i],
marfan$diameter[i],
col=alpha(i, 0.5))
lines(1, ci_prediction[newdata$patnr == subject_id,1], lty = 1, col = i)
lines(1, ci_prediction[newdata$patnr == subject_id,2], lty = 2, col= i)
lines(1, ci_prediction[newdata$patnr == subject_id,3], lty = 2, col= i)
}
for(i in 1:length(levels(marfan$patnr))){
subject_id_fig = levels(marfan$patnr)[i]
lines(marfan$age[marfan$patnr == subject_id_fig],
marfan$diameter[marfan$patnr == subject_id_fig],
col=alpha(i, 0.2))
}
plot(pred_one$age, pred_one$mean, xlab="Age", ylab="Diameter", type="l", col="red",
ylim=c(0, 80), xlim=c(18,75))
lines(pred_one$age, pred_one$mean +1.96*pred_one$SE, lty = 2, col="red")
lines(pred_one$age, pred_one$mean -1.96*pred_one$SE, lty = 2, col="red")
designmatixfig <- model.matrix(~age, pred_one)
predvarfig <- diag(designmatixfig %*% vcov(lmeAge3) %*% t(designmatixfig))
pred_one$SE <- sqrt(predvarfig)
pred_one$mean <- predict(lmeAge3, newdata = pred_one,
level = 0)
plot(pred_one$age, pred_one$mean, xlab="Age", ylab="Diameter", type="l", col="red",
ylim=c(0, 80), xlim=c(18,75))
lines(pred_one$age, pred_one$mean +1.96*pred_one$SE, lty = 2, col="red")
lines(pred_one$age, pred_one$mean -1.96*pred_one$SE, lty = 2, col="red")
for(i in 1:length(levels(marfan$patnr))){
subject_id_fig = levels(marfan$patnr)[i]
lines(marfan$age[marfan$patnr == subject_id_fig],
marfan$diameter[marfan$patnr == subject_id_fig],
col=alpha(i, 0.2))
}
designmatixfig <- model.matrix(~age, pred_one)
predvarfig <- diag(designmatixfig %*% vcov(lmeAge3) %*% t(designmatixfig))
pred_one$SE <- sqrt(predvarfig)
pred_one$mean <- predict(lmeAge3, newdata = pred_one,
level = 0)
plot(pred_one$age, pred_one$mean, xlab="Age", ylab="Diameter", type="l", col="red",
ylim=c(0, 65), xlim=c(20,40))
lines(pred_one$age, pred_one$mean +1.96*pred_one$SE, lty = 2, col="red")
lines(pred_one$age, pred_one$mean -1.96*pred_one$SE, lty = 2, col="red")
for(i in 1:length(levels(marfan$patnr))){
subject_id_fig = levels(marfan$patnr)[i]
lines(marfan$age[marfan$patnr == subject_id_fig],
marfan$diameter[marfan$patnr == subject_id_fig],
col=alpha(i, 0.2))
}
designmatixfig <- model.matrix(~age, pred_one)
predvarfig <- diag(designmatixfig %*% vcov(lmeAge3) %*% t(designmatixfig))
pred_one$SE <- sqrt(predvarfig)
pred_one$mean <- predict(lmeAge3, newdata = pred_one,
level = 0)
plot(pred_one$age, pred_one$mean, xlab="Age", ylab="Diameter", type="l", col="red",
ylim=c(30, 65), xlim=c(20,40))
lines(pred_one$age, pred_one$mean +1.96*pred_one$SE, lty = 2, col="red")
lines(pred_one$age, pred_one$mean -1.96*pred_one$SE, lty = 2, col="red")
for(i in 1:length(levels(marfan$patnr))){
subject_id_fig = levels(marfan$patnr)[i]
lines(marfan$age[marfan$patnr == subject_id_fig],
marfan$diameter[marfan$patnr == subject_id_fig],
col=alpha(i, 0.2))
}
designmatixfig <- model.matrix(~age, pred_one)
predvarfig <- diag(designmatixfig %*% vcov(lmeAge3) %*% t(designmatixfig))
pred_one$SE <- sqrt(predvarfig)
pred_one$mean <- predict(lmeAge3, newdata = pred_one,
level = 0)
plot(pred_one$age, pred_one$mean, xlab="Age", ylab="Diameter", type="l", col="red",
ylim=c(30, 65), xlim=c(20,40))
lines(pred_one$age, pred_one$mean +1.96*pred_one$SE, lty = 2, col="red")
lines(pred_one$age, pred_one$mean -1.96*pred_one$SE, lty = 2, col="red")
for(i in 1:length(levels(marfan$patnr))){
subject_id_fig = levels(marfan$patnr)[i]
lines(marfan$age[marfan$patnr == subject_id_fig],
marfan$diameter[marfan$patnr == subject_id_fig],
col=alpha(i, 0.2))
}
